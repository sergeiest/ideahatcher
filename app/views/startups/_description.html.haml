.description-box{:id => "description_#{description.id}"}
  - if params[:action] == 'show'
    .action-box
      .slider-bar
        %p Rate #{description.field_status.downcase}:
        = form_tag({:action => 'vote_description', :controller => 'votes'},
           :multipart => true, :id => "form_"+ description.id.to_s(), :remote => true) do
          = hidden_field :vote, :description_id, :value => description.id
          = hidden_field :vote, :score, :value => 3
          = hidden_field_tag :startup_id, description.startup_id
          = submit_tag 'submit', :id => "button_"+ description.id.to_s(), :hidden => true

        .scale-to-rate
          %span{:onMouseMove => "customHighlightIn(this)", :onMouseOut => "customHighlightOut(this)", :onclick => "rateThis(this, 1, #{description.id})",
                  :style => "border-left:1px grey solid;"} 1
          %span{:onMouseMove => "customHighlightIn(this)", :onMouseOut => "customHighlightOut(this)", :onclick => "rateThis(this, 2, #{description.id})"} 2
          %span{:onMouseMove => "customHighlightIn(this)", :onMouseOut => "customHighlightOut(this)", :onclick => "rateThis(this, 3, #{description.id})"} 3
          %span{:onMouseMove => "customHighlightIn(this)", :onMouseOut => "customHighlightOut(this)", :onclick => "rateThis(this, 4, #{description.id})"} 4
          %span{:onMouseMove => "customHighlightIn(this)", :onMouseOut => "customHighlightOut(this)", :onclick => "rateThis(this, 5, #{description.id})"} 5


  .description-statement
    %h5{:style => "font-weight:lighter"}= description.field_status
    %p= description.content
  .clear-both
  %a.help-hatch.custom-button{:onclick => "$('#ideahatching_#{description.id}').collapse('toggle')"}
    Help hatch it!

  .ideahatching.collapse{:id => "ideahatching_#{description.id}"}
    .idea-box
      .help-text
        %h5{:style => "font-weight:lighter"} Help hatch the #{description.field_status}
        %p
          Help the founders improve this idea and turn it into a successful business:
          %ol
            %li{:style => "font-weight:lighter"} Select which #{description.field_status} you like the most or which has the most potential.
            %li{:style => "font-weight:lighter"} Add your suggestions for this #{description.field_status} or participate in the discussion with other idea hatchers.
            %li{:style => "font-weight:lighter"} Follow the idea to see how it evolves, launches and succeeds thanks to your help!
      - if !description.companydescription_id.nil?
        .idea-statement{:onclick => "voteThis(this)"}
          - old_description = Companydescription.find(description.companydescription_id)
          = simple_format old_description.content.firstletters(500)
        %img{:src => "../images/versus-green.png"}
        .idea-statement{:onclick => "voteThis(this)"}
          = simple_format description.content.firstletters(500), :class => "p_new"
          -if session[:connection_type] == 2
            %i.icon-pencil.glyphw{:onclick => "editStep1(this.parentNode.parentNode)"}
      -else
        .idea-statement
          = simple_format description.content.firstletters(500), :class => "p_new"
          -if session[:connection_type] == 2
            %i.icon-pencil.glyphw{:onclick => "editStep1(this.parentNode.parentNode)"}
        %img{:src => "../images/versus-green.png"}
        .idea-statement.empty-statement
          %p No other versions available. Suggest a new one below.
      .clear-both

    .idea-box
      :ruby
        query_str = ""
        description_list = Array.new
        description_list << description.id
        current_description = description
        while current_description.companydescription_id != nil do
          description_list << current_description.companydescription_id
          current_description = @company_descriptions_all.select{|x| x.id == current_description.companydescription_id}.first
        end
        description_list.each do |disc_id|
          if query_str == ""
            query_str += 'companydescription_id = ' + disc_id.to_s()
          else
            query_str += ' OR companydescription_id = ' + disc_id.to_s()
          end
        end
      %hr
      .discussion{:id => "discussion_#{description.id}"}
        - ideas = Idea.where(query_str)
        - if ideas.nil? || ideas.length == 0
          %p.empty-comment There are no suggestions so far - be the first to contribute!
          %hr.middle-hr.empty-comment
        - ideas.each do |idea|
          = simple_format idea.content
          %p.author by #{idea.first_name} #{idea.last_name} on #{idea.created_at.strftime('%m/%d/%Y')}
          %hr.middle-hr
        = form_tag({:controller => "ideas", :action => "create"},:remote => true) do
          = hidden_field :idea, :title, :value => description.field_status
          = hidden_field :idea, :is_protected, :value => 0
          = hidden_field :idea, :idea_id, :value => ""
          = hidden_field :idea, :startup_id, :value => @startup.id
          = hidden_field :idea, :companydescription_id, :value => description.id
          = text_area :idea, :content, :value => "Add your suggestion here...", :onclick => "clearInput(this)"
          = submit_tag 'Save', :class => "startup-button-yellow"
          .clear-both
