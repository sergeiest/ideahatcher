.user-content
  %h5{:style => "font-weight: lighter;"} Update profile
  .profile-photo
    - if @user.avatar?
      = image_tag @user.avatar.url(:square), :class => "img-rounded-teaser"
    - else
      %img{:src => '/images/profile/Nophoto.png', :class => "img-rounded-teaser"}
    = image_tag '/images/pen.png', :class => "edit-pen",:href => "#uploadPhoto", :'data-toggle' => "modal", :style => "height:25px; width:25px;"

  .profile-info
    = form_for(@user) do |f|
      -if @user.errors.any?
        %p{:style => "color=red;"} Please correct the following errors in your form
      - if @user.errors[:firstname].length > 0
        %p{:style => "color=red;"} First name:
        = f.text_field :firstname, :style => "border-color:red"
      - else
        %p First name:
        = f.text_field :firstname
      - if @user.errors[:lastname].length > 0
        %p{:style => "color=red;"} Last name:
        = f.text_field :lastname, :style => "border-color:red"
      - else
        %p Last name:
        = f.text_field :lastname
      %p About me:
      = f.text_area :description

      = link_to do
        %button.custom-button{:style => "float:right"} Save

#uploadPhoto.modal.hide.fade{:tabindex => "-1", :role => "dialog", :'aria-labelledby' => "myModalLabel", :'aria-hidden' => "true"}
  .modal-header
    %button.close{ :type => "button", :'data-dismiss' => "modal", :'aria-hidden' => "true"} Ã—
    %h3{ :id => "myModalLabel"} Upload your new photo
  = form_for(@user) do |f|
    .modal-body
      %p Upload your photo (aspect ratio is 1:1).
      = f.file_field :avatar, :onchange => "checkFile(this)"
      %p#photo_error{ :style => "color:red"}
    .modal-footer
      %button{:class => "btn", :'data-dismiss' => "modal", :'aria-hidden' => "true"} Close
      =submit_tag 'Upload photo', :class => "btn btn-primary", :id => "photo_upload", :disabled => "true"

:javascript
  function checkFile(elementNode){
    var fileInput = elementNode;
    var fileName = fileInput.value;
    var ext = fileName.substring(fileName.lastIndexOf('.') + 1);
    if(ext == "gif" || ext == "GIF" || ext == "JPEG" || ext == "jpeg" || ext == "jpg" || ext == "JPG" || ext == "png" || ext == "PNG") {
      document.getElementById('photo_error').innerText = "";
      document.getElementById('photo_upload').disabled = false;
    }
    else
    {
      document.getElementById('photo_error').innerText = "Upload Gif or Jpg images only";
      document.getElementById('photo_upload').disabled = true;
      fup.focus();
    }
  }